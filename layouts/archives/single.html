{{ define "main" }}
{{ $pages := intersect (where .Site.RegularPages "Type" "in" (slice "docs" "posts" "weekly")) (where .Site.Pages "Params.date" "!=" nil)}}
{{partial "tags-navbar" .}}
{{ range $pages.GroupByDate "2006" }}
<section>
  <h1 style="color: dimgray;" id="{{ .Key }}">{{ .Key }}</h1>
  <div class="posts">
    {{ range .Pages }}
    <div class="post">
      <p>
        <h3><time style="color: darkgrey;">{{.Date.Format "2006-01-02"}}</time>&nbsp;»&nbsp;
          {{ if eq .Type "docs"}}
            <a href="{{ .RelPermalink }}" style="color: gray;">
            {{- $currentDir := path.Base .File.Dir | title -}}
            {{- $parentDir := path.Base (path.Dir (path.Dir .File.Dir)) | title -}}
            {{- if eq $parentDir "Docs" -}}
              {{- $currentDir -}} »
            {{- else -}}
              {{- $parentDir -}} » {{- $currentDir -}} »
            {{- end -}}
            {{ .Title }}
            </a>
          {{ else }}
            <a href="{{ .RelPermalink }}">
              {{ .Title }}
            </a>
          {{ end }}
          {{ partial "tags-label" . }}
        </h3>
      </p>
    </div>
    {{ end }}
  </div>
</section>
{{ end }}
{{ end }}

{{ define "toc" }}
  {{ partial "categories" . }}
{{ end }}
